exports.ids=[2],exports.modules={114:function(t,e,o){"use strict";o.r(e);var r=o(78),l=o.n(r);for(var n in r)"default"!==n&&function(t){o.d(e,t,(function(){return r[t]}))}(n);e.default=l.a},115:function(t,e,o){(e=o(2)(!1)).push([t.i,".upload-box[data-v-487ffb50]{margin-bottom:1.25rem}.form .input-new-tag[data-v-487ffb50]{width:auto}.form .input[data-v-487ffb50] .el-input__inner:focus{border:.125rem solid #7d7d7d;background-color:#f0f2f5}.form .tag[data-v-487ffb50]:not(:last-of-type){margin-right:.3125rem}[data-v-487ffb50] .is-disabled.submit-btn{color:#fff}",""]),t.exports=e},116:function(t,e,o){"use strict";o.r(e);var r=o(79),l=o.n(r);for(var n in r)"default"!==n&&function(t){o.d(e,t,(function(){return r[t]}))}(n);e.default=l.a},117:function(t,e,o){(e=o(2)(!1)).push([t.i,".template-item[data-v-a7965c14]{border-radius:1.25rem}.template-item .template-cover-row[data-v-a7965c14]{position:relative;max-width:100%;height:0;padding-bottom:60%;overflow:hidden;border-radius:.3125rem;cursor:pointer!important}.template-item .template-mask[data-v-a7965c14]{display:flex;flex-direction:column;justify-content:flex-end;position:absolute;top:0;right:0;width:100%;height:100%;opacity:0;transition:all .3s;background-image:linear-gradient(180deg,transparent 62%,rgba(0,0,0,.00345888) 63.94%,rgba(0,0,0,.014204) 65.89%,rgba(0,0,0,.0326639) 67.83%,rgba(0,0,0,.0589645) 69.78%,rgba(0,0,0,.0927099) 71.72%,rgba(0,0,0,.132754) 73.67%,rgba(0,0,0,.177076) 75.61%,rgba(0,0,0,.222924) 77.56%,rgba(0,0,0,.267246) 79.5%,rgba(0,0,0,.30729) 81.44%,rgba(0,0,0,.341035) 83.39%,rgba(0,0,0,.367336) 85.33%,rgba(0,0,0,.385796) 87.28%,rgba(0,0,0,.396541) 89.22%,rgba(0,0,0,.4) 91.17%)}.template-item .template-mask[data-v-a7965c14]:hover{opacity:1}.template-item .template-mask .username[data-v-a7965c14]{padding:1.875rem 1.25rem;color:#fff;font-weight:700}.template-item .template-cover[data-v-a7965c14]{position:absolute;width:100%;height:100%}.template-item .template-info[data-v-a7965c14]{display:flex;justify-content:space-between;height:1.875rem;padding:0 .3125rem}.template-item .template-info .name[data-v-a7965c14]{font-size:.875rem;line-height:1.875rem;color:#636363}.template-item .template-info .more[data-v-a7965c14]{height:1.875rem;padding:.4375rem 0;cursor:pointer}.template-item .delete-info[data-v-a7965c14]{font-size:.875rem}.template-item .resource-check[data-v-a7965c14]{font-size:.75rem;margin-top:.625rem;font-weight:400;color:#999}",""]),t.exports=e},118:function(t,e,o){"use strict";o.r(e);var r=o(80),l=o.n(r);for(var n in r)"default"!==n&&function(t){o.d(e,t,(function(){return r[t]}))}(n);e.default=l.a},119:function(t,e,o){(e=o(2)(!1)).push([t.i,".page .header[data-v-4355d8b8]{display:flex;justify-content:space-between}.page .header .nav-bar[data-v-4355d8b8]{display:flex;list-style:none;padding:0;margin-bottom:1.25rem}.page .header .nav-bar .nav-item[data-v-4355d8b8]{padding:.3125rem 1.875rem;border-radius:.3125rem;cursor:pointer;color:#636363;transition:all .2s}.page .header .nav-bar .nav-item[data-v-4355d8b8]:not(:last-of-type){margin-right:1.25rem}.page .header .nav-bar .nav-item[data-v-4355d8b8]:hover{background-color:#c3c3c3;color:#333}.page .header .nav-bar .nav-item.active[data-v-4355d8b8],.page .header .nav-bar .nav-item.active[data-v-4355d8b8]:hover{background-color:#606266;color:#f0e26a}.page .header .nav-bar .nav-item.btn[data-v-4355d8b8]{font-size:.75rem;padding:.3125rem 1.25rem;background-color:#606266;color:#f0e26a}.page .template .template-list[data-v-4355d8b8]{display:grid;grid-template-columns:repeat(auto-fill,minmax(18.75rem,.8fr));grid-gap:1.25rem}.page .template .load[data-v-4355d8b8]{text-align:center;margin:1.25rem 0}.page .template .load .no-more[data-v-4355d8b8]{font-size:.75rem;color:#777}",""]),t.exports=e},121:function(t,e,o){"use strict";o.r(e);var r=o(5),l=o(75),n=o.n(l),d={props:{show:{type:Boolean,default:()=>!1}},computed:{header:{get(){return{Authorization:"Bearer "+this.$store.state.user.token}}},dialogVisible:{get(){return this.show},set(t){this.loading||this.$emit("close")}}},data:()=>({loading:!1,host:n.a.production.ENV_API,inputVisible:!1,fileList:[],filepath:"",name:"",tag:"",tags:[]}),methods:{successUpload(t){"0"===t.code?this.filepath=t.data:this.$message.error("上传错误")},errorUpload(t){401===t.status?this.$alert("请重新登录","登录超时",{confirmButtonText:"确定",callback:t=>{this.$router.replace("/login")}}):this.$message.error("上传错误")},closeTag(t){this.tags.splice(this.tags.indexOf(t),1)},showInput(){this.inputVisible=!0,this.$nextTick(t=>{this.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm(){let t=this.tag;const e=this.tags.indexOf(t);t&&-1===e&&this.tags.push(t),this.inputVisible=!1,this.tag=""},createTemplate(){const template={name:this.name,filepath:this.filepath,tag:this.tags.join()};this.loading=!0,this.$store.dispatch("template/createTemplate",template).then(t=>{this.loading=!1,200===t.status&&"0"===t.data.code?(this.$message.success("上传成功"),this.dialogVisible=!1):this.$message.error("上传失败")}).catch(t=>{this.loading=!1})}}},c=o(4);var m=Object(c.a)(d,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{title:"模板上传",visible:t.dialogVisible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-upload",{staticClass:"upload-box",attrs:{action:t.host+"/template/upload",headers:t.header,"on-success":t.successUpload,"on-error":t.errorUpload,limit:1,"file-list":t.fileList}},[o("el-button",{attrs:{size:"small",type:"primary",disabled:t.loading}},[t._v("点击上传")]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传psd文件，且不超过20Mb")])],1),t._v(" "),o("el-form",{staticClass:"form"},[o("el-form-item",{attrs:{required:""}},[o("el-input",{staticClass:"input",attrs:{disabled:t.loading,placeholder:"请输入模板名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),o("el-form-item",{attrs:{required:"",label:"标签"}},[t.inputVisible?o("el-input",{ref:"saveTagInput",staticClass:"input input-new-tag",attrs:{size:"small",placeholder:"回车确认输入"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}}):o("el-button",{staticClass:"button-new-tag",attrs:{size:"small",disabled:t.loading},on:{click:t.showInput}},[t._v("+ 新增标签")]),t._v(" "),t._l(t.tags,(function(e){return o("el-tag",{key:e,staticClass:"tag",attrs:{closable:!t.loading,"disable-transitions":!1},on:{close:function(o){return t.closeTag(e)}}},[t._v(t._s(e))])}))],2)],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.loading?t._e():o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.createTemplate}},[t._v(t._s(t.loading?"保 存 中 请 勿 关 闭":"确 定"))])],1)],1)}),[],!1,(function(t){var e=o(114);e.__inject__&&e.__inject__(t)}),"487ffb50","6284c10c").exports,h={props:{id:String,name:String,cover:String,username:String},computed:{...Object(r.mapState)({isAdmin:t=>t.user.isAdmin}),templates:{get(){return this.$store.state.template.list},set(t){this.$store.commit("template/SET_LIST",t)}},count:{get(){return this.$store.state.template.count},set(t){this.$store.commit("template/SET_COUNT",t)}}},data:()=>({dialogVisible:!1,bothResource:!1}),methods:{toEditor(t){this.$router.push("/editor?id="+t)},handleCommand(t){"delete"===t&&this.handleDelete()},handleDelete(){this.dialogVisible=!0,this.bothResource=!1},checkDelete(){this.$store.dispatch("template/delete",{id:this.id,bothResource:this.bothResource}).then(t=>{200===t.status&&"0"===t.data.code?(this.$message.success("删除成功"),this.templates=this.templates.filter(t=>t._id!==this.id),this.count--):this.$message.error("删除失败"),this.dialogVisible=!1})}}};var v={middleware:"verify",components:{TemplateCover:Object(c.a)(h,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"template-item"},[t._ssrNode('<div class="template-cover-row" data-v-a7965c14><img'+t._ssrAttr("src",t.cover)+' class="template-cover" data-v-a7965c14> <div class="template-mask" data-v-a7965c14><p class="username" data-v-a7965c14>'+t._ssrEscape(t._s(t.username))+"</p></div></div> "),t._ssrNode('<div class="template-info" data-v-a7965c14>',"</div>",[t._ssrNode('<p class="name" data-v-a7965c14>'+t._ssrEscape(t._s(t.name))+"</p> "),t.isAdmin?o("el-dropdown",{staticClass:"more",attrs:{trigger:"click"},on:{command:t.handleCommand}},[o("span",{staticClass:"el-dropdown-link"},[o("i",{staticClass:"el-icon-more el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{staticStyle:{color:"#F56C6C"},attrs:{icon:"el-icon-delete",command:"delete"}},[t._v("删除")])],1)],1):t._e()],2),t._ssrNode(" "),o("el-dialog",{attrs:{title:"删除模板",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("p",{staticClass:"delete-info"},[o("i",{staticClass:"el-icon-warning",staticStyle:{color:"#E6A23C"}}),t._v(" "),o("span",[t._v("你确认要删除该模板吗？[ 操作无法撤销 ]")])]),t._v(" "),o("el-checkbox",{staticClass:"resource-check",model:{value:t.bothResource,callback:function(e){t.bothResource=e},expression:"bothResource"}},[t._v("同时删除模板素材文件")]),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.checkDelete}},[t._v("确 定")])],1)],1)],2)}),[],!1,(function(t){var e=o(116);e.__inject__&&e.__inject__(t)}),"a7965c14","0a099463").exports,UploadDialog:m},computed:{...Object(r.mapState)({isAdmin:t=>t.user.isAdmin,count:t=>t.template.count}),templates:{get(){return this.$store.state.template.list},set(t){this.$store.commit("template/SET_LIST",t)}},page:{get(){return this.$store.state.template.page},set(t){this.$store.commit("template/SET_PAGE",t)}},pageSize:{get(){return this.$store.state.template.pageSize},set(t){this.$store.commit("template/SET_PAGE_SIZE",t)}}},mounted(){this.initList()},data:()=>({uploadDialog:!1,activeNav:1}),methods:{selectNav(nav){this.activeNav=nav},openUploadDialog(){this.uploadDialog=!0},closeUploadDialog(){this.uploadDialog=!1},async initList(){this.templates=[],this.page=1;const t=await this.$store.dispatch("template/getList");t.length<1?this.$message.error("加载失败"):this.templates=t},async getMore(){this.page+=1;const t=await this.$store.dispatch("template/getList");t.length<1?this.$message.error("加载失败"):this.templates=[...this.templates,...t]}}};var f=Object(c.a)(v,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page"},[t._ssrNode('<div class="header" data-v-4355d8b8><ul class="nav-bar" data-v-4355d8b8><li'+t._ssrClass("nav-item",{active:1===t.activeNav})+' data-v-4355d8b8>全部</li></ul> <ul class="nav-bar" data-v-4355d8b8>'+(t.isAdmin?'<li class="nav-item btn" data-v-4355d8b8>上传模板</li>':"\x3c!----\x3e")+"</ul></div> "),t._ssrNode('<section class="template" data-v-4355d8b8>',"</section>",[t._ssrNode('<div class="template-list" data-v-4355d8b8>',"</div>",t._l(t.templates,(function(t){return o("template-cover",{key:t._id,attrs:{id:t._id,name:t.name,cover:t.cover,username:t.author.username}})})),1),t._ssrNode(" "),t._ssrNode('<div class="load" data-v-4355d8b8>',"</div>",[t.count!==t.templates.length?o("el-button",{staticClass:"load-more",attrs:{size:"small"},on:{click:t.getMore}},[t._v("加载更多")]):o("p",{staticClass:"no-more"},[t._v("没有更多了 (#^.^#)")])],1)],2),t._ssrNode(" "),o("upload-dialog",{attrs:{show:t.uploadDialog},on:{close:t.closeUploadDialog}})],2)}),[],!1,(function(t){var e=o(118);e.__inject__&&e.__inject__(t)}),"4355d8b8","419b9030");e.default=f.exports},75:function(t,e){t.exports={development:{NODE_ENV:"development",ENV_API:"http://127.0.0.1:3300",ROUTER_BASE:"/"},production:{NODE_ENV:"production",ENV_API:"http://api.toolbee.cn",ROUTER_BASE:"/"}}},78:function(t,e,o){var content=o(115);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var r=o(3).default;t.exports.__inject__=function(t){r("76a2eddd",content,!0,t)}},79:function(t,e,o){var content=o(117);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var r=o(3).default;t.exports.__inject__=function(t){r("773d57d8",content,!0,t)}},80:function(t,e,o){var content=o(119);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var r=o(3).default;t.exports.__inject__=function(t){r("588fef1f",content,!0,t)}}};