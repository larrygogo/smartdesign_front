(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{878:function(t,e){t.exports={development:{NODE_ENV:"development",ENV_API:"http://127.0.0.1:3300",ROUTER_BASE:"/"},production:{NODE_ENV:"production",ENV_API:"http://api.toolbee.cn",ROUTER_BASE:"/"}}},881:function(t,e,o){var content=o(921);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(50).default)("76a2eddd",content,!0,{sourceMap:!1})},882:function(t,e,o){var content=o(923);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(50).default)("773d57d8",content,!0,{sourceMap:!1})},883:function(t,e,o){var content=o(925);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(50).default)("588fef1f",content,!0,{sourceMap:!1})},884:function(t,e,o){"use strict";o.d(e,"a",(function(){return l}));var n=o(218);var r=o(262);function l(t){return function(t){if(Array.isArray(t))return Object(n.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(r.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},920:function(t,e,o){"use strict";var n=o(881);o.n(n).a},921:function(t,e,o){(e=o(49)(!1)).push([t.i,".upload-box[data-v-487ffb50]{margin-bottom:1.25rem}.form .input-new-tag[data-v-487ffb50]{width:auto}.form .input[data-v-487ffb50] .el-input__inner:focus{border:.125rem solid #7d7d7d;background-color:#f0f2f5}.form .tag[data-v-487ffb50]:not(:last-of-type){margin-right:.3125rem}[data-v-487ffb50] .is-disabled.submit-btn{color:#fff}",""]),t.exports=e},922:function(t,e,o){"use strict";var n=o(882);o.n(n).a},923:function(t,e,o){(e=o(49)(!1)).push([t.i,".template-item[data-v-a7965c14]{border-radius:1.25rem}.template-item .template-cover-row[data-v-a7965c14]{position:relative;max-width:100%;height:0;padding-bottom:60%;overflow:hidden;border-radius:.3125rem;cursor:pointer!important}.template-item .template-mask[data-v-a7965c14]{display:flex;flex-direction:column;justify-content:flex-end;position:absolute;top:0;right:0;width:100%;height:100%;opacity:0;transition:all .3s;background-image:linear-gradient(180deg,transparent 62%,rgba(0,0,0,.00345888) 63.94%,rgba(0,0,0,.014204) 65.89%,rgba(0,0,0,.0326639) 67.83%,rgba(0,0,0,.0589645) 69.78%,rgba(0,0,0,.0927099) 71.72%,rgba(0,0,0,.132754) 73.67%,rgba(0,0,0,.177076) 75.61%,rgba(0,0,0,.222924) 77.56%,rgba(0,0,0,.267246) 79.5%,rgba(0,0,0,.30729) 81.44%,rgba(0,0,0,.341035) 83.39%,rgba(0,0,0,.367336) 85.33%,rgba(0,0,0,.385796) 87.28%,rgba(0,0,0,.396541) 89.22%,rgba(0,0,0,.4) 91.17%)}.template-item .template-mask[data-v-a7965c14]:hover{opacity:1}.template-item .template-mask .username[data-v-a7965c14]{padding:1.875rem 1.25rem;color:#fff;font-weight:700}.template-item .template-cover[data-v-a7965c14]{position:absolute;width:100%;height:100%}.template-item .template-info[data-v-a7965c14]{display:flex;justify-content:space-between;height:1.875rem;padding:0 .3125rem}.template-item .template-info .name[data-v-a7965c14]{font-size:.875rem;line-height:1.875rem;color:#636363}.template-item .template-info .more[data-v-a7965c14]{height:1.875rem;padding:.4375rem 0;cursor:pointer}.template-item .delete-info[data-v-a7965c14]{font-size:.875rem}.template-item .resource-check[data-v-a7965c14]{font-size:.75rem;margin-top:.625rem;font-weight:400;color:#999}",""]),t.exports=e},924:function(t,e,o){"use strict";var n=o(883);o.n(n).a},925:function(t,e,o){(e=o(49)(!1)).push([t.i,".page .header[data-v-4355d8b8]{display:flex;justify-content:space-between}.page .header .nav-bar[data-v-4355d8b8]{display:flex;list-style:none;padding:0;margin-bottom:1.25rem}.page .header .nav-bar .nav-item[data-v-4355d8b8]{padding:.3125rem 1.875rem;border-radius:.3125rem;cursor:pointer;color:#636363;transition:all .2s}.page .header .nav-bar .nav-item[data-v-4355d8b8]:not(:last-of-type){margin-right:1.25rem}.page .header .nav-bar .nav-item[data-v-4355d8b8]:hover{background-color:#c3c3c3;color:#333}.page .header .nav-bar .nav-item.active[data-v-4355d8b8],.page .header .nav-bar .nav-item.active[data-v-4355d8b8]:hover{background-color:#606266;color:#f0e26a}.page .header .nav-bar .nav-item.btn[data-v-4355d8b8]{font-size:.75rem;padding:.3125rem 1.25rem;background-color:#606266;color:#f0e26a}.page .template .template-list[data-v-4355d8b8]{display:grid;grid-template-columns:repeat(auto-fill,minmax(18.75rem,.8fr));grid-gap:1.25rem}.page .template .load[data-v-4355d8b8]{text-align:center;margin:1.25rem 0}.page .template .load .no-more[data-v-4355d8b8]{font-size:.75rem;color:#777}",""]),t.exports=e},927:function(t,e,o){"use strict";o.r(e);o(260),o(62),o(63),o(33),o(185);var n=o(884),r=(o(34),o(8)),l=o(137),c=o(82),d=(o(43),o(85),o(878)),m=o.n(d),f={props:{show:{type:Boolean,default:function(){return!1}}},computed:{header:{get:function(){return{Authorization:"Bearer ".concat(this.$store.state.user.token)}}},dialogVisible:{get:function(){return this.show},set:function(t){this.loading||this.$emit("close")}}},data:function(){return{loading:!1,host:m.a.production.ENV_API,inputVisible:!1,fileList:[],filepath:"",name:"",tag:"",tags:[]}},methods:{successUpload:function(t){"0"===t.code?this.filepath=t.data:this.$message.error("上传错误")},errorUpload:function(t){var e=this;401===t.status?this.$alert("请重新登录","登录超时",{confirmButtonText:"确定",callback:function(t){e.$router.replace("/login")}}):this.$message.error("上传错误")},closeTag:function(t){this.tags.splice(this.tags.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.tag,e=this.tags.indexOf(t);t&&-1===e&&this.tags.push(t),this.inputVisible=!1,this.tag=""},createTemplate:function(){var t=this,template={name:this.name,filepath:this.filepath,tag:this.tags.join()};this.loading=!0,this.$store.dispatch("template/createTemplate",template).then((function(e){t.loading=!1,200===e.status&&"0"===e.data.code?(t.$message.success("上传成功"),t.dialogVisible=!1):t.$message.error("上传失败")})).catch((function(e){t.loading=!1}))}}},v=(o(920),o(51)),h=Object(v.a)(f,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{title:"模板上传",visible:t.dialogVisible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-upload",{staticClass:"upload-box",attrs:{action:t.host+"/template/upload",headers:t.header,"on-success":t.successUpload,"on-error":t.errorUpload,limit:1,"file-list":t.fileList}},[o("el-button",{attrs:{size:"small",type:"primary",disabled:t.loading}},[t._v("点击上传")]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传psd文件，且不超过20Mb")])],1),t._v(" "),o("el-form",{staticClass:"form"},[o("el-form-item",{attrs:{required:""}},[o("el-input",{staticClass:"input",attrs:{disabled:t.loading,placeholder:"请输入模板名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),o("el-form-item",{attrs:{required:"",label:"标签"}},[t.inputVisible?o("el-input",{ref:"saveTagInput",staticClass:"input input-new-tag",attrs:{size:"small",placeholder:"回车确认输入"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}}):o("el-button",{staticClass:"button-new-tag",attrs:{size:"small",disabled:t.loading},on:{click:t.showInput}},[t._v("+ 新增标签")]),t._v(" "),t._l(t.tags,(function(e){return o("el-tag",{key:e,staticClass:"tag",attrs:{closable:!t.loading,"disable-transitions":!1},on:{close:function(o){return t.closeTag(e)}}},[t._v(t._s(e))])}))],2)],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.loading?t._e():o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.createTemplate}},[t._v(t._s(t.loading?"保 存 中 请 勿 关 闭":"确 定"))])],1)],1)}),[],!1,null,"487ffb50",null).exports;function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}var y={props:{id:String,name:String,cover:String,username:String},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(l.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(c.b)({isAdmin:function(t){return t.user.isAdmin}}),{templates:{get:function(){return this.$store.state.template.list},set:function(t){this.$store.commit("template/SET_LIST",t)}},count:{get:function(){return this.$store.state.template.count},set:function(t){this.$store.commit("template/SET_COUNT",t)}}}),data:function(){return{dialogVisible:!1,bothResource:!1}},methods:{toEditor:function(t){this.$router.push("/editor?id="+t)},handleCommand:function(t){"delete"===t&&this.handleDelete()},handleDelete:function(){this.dialogVisible=!0,this.bothResource=!1},checkDelete:function(){var t=this;this.$store.dispatch("template/delete",{id:this.id,bothResource:this.bothResource}).then((function(e){200===e.status&&"0"===e.data.code?(t.$message.success("删除成功"),t.templates=t.templates.filter((function(e){return e._id!==t.id})),t.count--):t.$message.error("删除失败"),t.dialogVisible=!1}))}}};o(922);function O(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}var w={middleware:"verify",components:{TemplateCover:Object(v.a)(y,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"template-item"},[o("div",{staticClass:"template-cover-row",on:{click:function(e){return t.toEditor(t.id)}}},[o("img",{staticClass:"template-cover",attrs:{src:t.cover}}),t._v(" "),o("div",{staticClass:"template-mask"},[o("p",{staticClass:"username"},[t._v(t._s(t.username))])])]),t._v(" "),o("div",{staticClass:"template-info"},[o("p",{staticClass:"name"},[t._v(t._s(t.name))]),t._v(" "),t.isAdmin?o("el-dropdown",{staticClass:"more",attrs:{trigger:"click"},on:{command:t.handleCommand}},[o("span",{staticClass:"el-dropdown-link"},[o("i",{staticClass:"el-icon-more el-icon--right"})]),t._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{staticStyle:{color:"#F56C6C"},attrs:{icon:"el-icon-delete",command:"delete"}},[t._v("删除")])],1)],1):t._e()],1),t._v(" "),o("el-dialog",{attrs:{title:"删除模板",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("p",{staticClass:"delete-info"},[o("i",{staticClass:"el-icon-warning",staticStyle:{color:"#E6A23C"}}),t._v(" "),o("span",[t._v("你确认要删除该模板吗？[ 操作无法撤销 ]")])]),t._v(" "),o("el-checkbox",{staticClass:"resource-check",model:{value:t.bothResource,callback:function(e){t.bothResource=e},expression:"bothResource"}},[t._v("同时删除模板素材文件")]),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.checkDelete}},[t._v("确 定")])],1)],1)],1)}),[],!1,null,"a7965c14",null).exports,UploadDialog:h},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(e){Object(l.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(c.b)({isAdmin:function(t){return t.user.isAdmin},count:function(t){return t.template.count}}),{templates:{get:function(){return this.$store.state.template.list},set:function(t){this.$store.commit("template/SET_LIST",t)}},page:{get:function(){return this.$store.state.template.page},set:function(t){this.$store.commit("template/SET_PAGE",t)}},pageSize:{get:function(){return this.$store.state.template.pageSize},set:function(t){this.$store.commit("template/SET_PAGE_SIZE",t)}}}),mounted:function(){this.initList()},data:function(){return{uploadDialog:!1,activeNav:1}},methods:{selectNav:function(nav){this.activeNav=nav},openUploadDialog:function(){this.uploadDialog=!0},closeUploadDialog:function(){this.uploadDialog=!1},initList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.templates=[],t.page=1,e.next=4,t.$store.dispatch("template/getList");case 4:(o=e.sent).length<1?t.$message.error("加载失败"):t.templates=o;case 6:case"end":return e.stop()}}),e)})))()},getMore:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.page+=1,e.next=3,t.$store.dispatch("template/getList");case 3:(o=e.sent).length<1?t.$message.error("加载失败"):t.templates=[].concat(Object(n.a)(t.templates),Object(n.a)(o));case 5:case"end":return e.stop()}}),e)})))()}}},k=(o(924),Object(v.a)(w,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page"},[o("div",{staticClass:"header"},[o("ul",{staticClass:"nav-bar"},[o("li",{staticClass:"nav-item",class:{active:1===t.activeNav},on:{click:function(e){return t.selectNav(1)}}},[t._v("全部")])]),t._v(" "),o("ul",{staticClass:"nav-bar"},[t.isAdmin?o("li",{staticClass:"nav-item btn",on:{click:t.openUploadDialog}},[t._v("上传模板")]):t._e()])]),t._v(" "),o("section",{staticClass:"template"},[o("div",{staticClass:"template-list"},t._l(t.templates,(function(t){return o("template-cover",{key:t._id,attrs:{id:t._id,name:t.name,cover:t.cover,username:t.author.username}})})),1),t._v(" "),o("div",{staticClass:"load"},[t.count!==t.templates.length?o("el-button",{staticClass:"load-more",attrs:{size:"small"},on:{click:t.getMore}},[t._v("加载更多")]):o("p",{staticClass:"no-more"},[t._v("没有更多了 (#^.^#)")])],1)]),t._v(" "),o("upload-dialog",{attrs:{show:t.uploadDialog},on:{close:t.closeUploadDialog}})],1)}),[],!1,null,"4355d8b8",null));e.default=k.exports}}]);